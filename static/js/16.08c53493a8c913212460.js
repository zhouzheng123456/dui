webpackJsonp([16],{XilK:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("oast"),a=i("+EaS"),o=i("4PKW"),s=i("wSez"),c=i("pOZS"),r=i.n(c),d=(n.a,a.a,o.a,{components:{XButton:n.a,Flexbox:a.a,FlexboxItem:o.a},data:function(){return{face_bmg:r.a,video:null,img:"",match_img:""}},computed:{},beforeMount:function(){},mounted:function(){this.$refs.content_box.style.height=document.documentElement.clientHeight-97+"px",this.initVideo()},methods:{goBack:function(){this.$router.go(-1)},initVideo:function(){var t=this;window.URL||window.webkitURL;navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,navigator.getUserMedia({video:!0},function(e){t.video=document.getElementById("video"),t.width=t.video.width,t.height=t.video.height,t.video.srcObject=e,t.video.play()},function(t){alert(t.name),console.log(t.name||t)})},screenShot:function(){this.video=document.getElementById("video");var t=this.video.width,e=this.video.height,i=t/e;e=(t=240)/i;var n=document.getElementById("canvas");n.width=t,n.height=e,n.getContext("2d").drawImage(this.video,0,0,t,e);var a=n.toDataURL("image/*",1);this.img=a},start_in:function(){this.screenShot()},end_in:function(){var t=this;if(""==this.img)Object(s.MessageBox)("提示","请先点击采集");else{this.img=this.img.split("base64,")[1];var e='{\n"image": "'+this.img+'",\n"image_type":"BASE64",\n"face_type": "LIVE",\n"face_field":"age,gender"\n}';this.$API.IDS_API.detect(e).then(function(e){0==e.data.error_code?(localStorage.setItem("face_img",t.img),t.$router.push("/")):Object(s.MessageBox)("提示","未检测到人脸"),console.log("返回",e)}).catch(function(t){Object(s.MessageBox)("提示","未检测到人脸"),console.log(t)})}},match:function(){}},watch:{}}),l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("mt-header",{attrs:{title:"人脸采集"}},[i("span",{attrs:{slot:"left"},on:{click:t.goBack},slot:"left"},[i("mt-button",{attrs:{icon:"back"}})],1)]),t._v(" "),i("div",{ref:"content_box",staticClass:"bmg_css",style:{backgroundImage:"url("+t.face_bmg+")"}},[t._m(0),t._v(" "),t._m(1)]),t._v(" "),i("flexbox",[i("flexbox-item",[i("x-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.start_in(e)}}},[t._v("点击采集")])],1),t._v(" "),i("flexbox-item",[i("x-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.end_in(e)}}},[t._v("完成采集")])],1)],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"video_box"},[e("video",{attrs:{id:"video",height:"150",width:"150",poster:i("lZli")}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"snap"},[e("canvas",{attrs:{id:"canvas",height:"150",width:"150"}})])}]};var g=i("C7Lr")(d,l,!1,function(t){i("tlBf")},"data-v-4c119924",null);e.default=g.exports},pOZS:function(t,e,i){t.exports=i.p+"static/img/face_in.8d0e2fa.jpg"},tlBf:function(t,e){}});
//# sourceMappingURL=16.08c53493a8c913212460.js.map